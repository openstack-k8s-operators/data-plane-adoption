- name: Prelude
  hosts: local
  gather_facts: false
  module_defaults:
    ansible.builtin.shell:
      executable: /bin/bash
  roles:
    - prelude_local

- name: Cleanup
  hosts: local
  gather_facts: false
  module_defaults:
    ansible.builtin.shell:
      executable: /bin/bash
  roles:
    - pcp_cleanup

# TODO need to execute the first 4 roles against the "controller" host
# supplied by zuul,
# two ways about it :
# 1. add controller to the inventory and call delegate_to (localhost or controller) in the role level
# 2.extract the controler hostname and pass and use the ssh commands as is in patch.

- name: Adoption
  hosts: local
  gather_facts: false
  module_defaults:
    ansible.builtin.shell:
      executable: /bin/bash
  roles:
     - backend_services
     - stop_openstack_services
     - mariadb_copy
     - ovn_adoption
     - keystone_adoption
     - neutron_adoption
     - glance_adoption
     - placement_adoption
     - cinder_adoption
     - horizon_adoption
     - dataplane_adoption
     - heat_adoption
