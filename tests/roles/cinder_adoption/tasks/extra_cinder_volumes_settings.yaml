---
- name: Generate the nodeSelector patch for the Cinder volumes
  ansible.builtin.template:
    src: cinder_volumes_extra_nodeselector.yaml.j2
    dest: /tmp/cinder_volumes_extra_nodeselector.yaml
    mode: "0600"

- name: Apply the nodeSelector patch for the Cinder volumes
  ansible.builtin.shell: |
    {{ shell_header }}
    {{ oc_header }}
    oc patch openstackcontrolplane openstack --type=merge --patch-file=/tmp/cinder_volumes_extra_nodeselector.yaml
